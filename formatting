# Format boot partition as FAT32
mkfs.fat -F32 $ARSH_BOOT_PARTITION

mkswap $ARSH_SWAP_PARTITION
swapon $ARSH_SWAP_PARTITION

# Setup LUKS encryption on root partition
printf "$ENCRYPTED_PARTITION_PASSWORD" | cryptsetup luksFormat -v $ARSH_ROOT_PARTITION -d -

# Temporarily open encrypted partition in order to format it
printf "$ENCRYPTED_PARTITION_PASSWORD" | cryptsetup open $ARSH_ROOT_PARTITION $ENCRYPTED_PARTITION_NAME -d -

# Format main partition as ext4
mkfs.ext4 "/dev/mapper/$ENCRYPTED_PARTITION_NAME"

# Mount filesystem over the live system
mount "/dev/mapper/$ENCRYPTED_PARTITION_NAME" /mnt

# Create EFI directory
mkdir /mnt/boot

# Mount boot partition to it's respective directory
mount $ARSH_BOOT_PARTITION /mnt/boot
